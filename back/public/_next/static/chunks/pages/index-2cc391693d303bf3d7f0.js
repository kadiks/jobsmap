(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{2656:function(e,n,r){"use strict";r.r(n),r.d(n,{__N_SSG:function(){return k},default:function(){return O}});var t=r(5893),o=r(18),i=r(7294),c=r(9008),s=r(5152),l=r(1664),a=(r(1330),r(3802),function(e){var n=e.children,r=e.className,i=void 0===r?"":r,c=e.onClick,s=void 0===c?function(){}:c,l=["focus:outline-none"].concat((0,o.Z)(i.split(" ")));return(0,t.jsx)("button",{className:l.join(" "),onClick:s,children:n})}),u=function(e){var n=e.buttons,r=e.selectedId,o=e.onChange,i=void 0===o?function(){}:o;r||(r=n[0].id);return(0,t.jsx)("div",{className:"tab-group flex justify-center text-white",children:n.map((function(e,o){var c=e.id,s=e.name;console.log("buttons.map");var l=["border","py-1","px-2","hover:bg-indigo-100","hover:text-indigo-600","hover:shadow-inner","hover:border-indigo-200"];return 0===o&&(l.push("rounded-l-lg"),l.push("border-r-0")),n.length===o+1&&l.push("rounded-r-lg"),r===c&&(l.push("bg-indigo-100"),l.push("text-indigo-600")),(0,t.jsx)(a,{className:l.join(" "),onClick:function(){return function(e){i(e)}(c)},children:s},c)}))})},d=r(6156);function f(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function h(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?f(Object(r),!0).forEach((function(n){(0,d.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):f(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var p=function(e){var n=e.name,r=e.value,o=e.coords,i=e.onClick;return(0,t.jsxs)("li",{onClick:function(){return i(o)},className:"flex p-1 border-b border-indigo-500 cursor-pointer hover:bg-indigo-500 hover:text-indigo-800",children:[(0,t.jsx)("span",{className:"flex-grow font-sans",children:n}),(0,t.jsx)("span",{className:"text-indigo-300 font-sans",children:r})]})},v=function(e){var n=e.cities,r=void 0===n?[{name:"Paris",value:1234},{name:"Paris",value:1234}]:n,o=e.onClick,i=void 0===o?function(){}:o;return(0,t.jsx)("ul",{className:"text-white overflow-scroll",style:{overflow:"scroll",height:"70vh"},children:r.map((function(e,n){return(0,t.jsx)(p,h(h({},e),{},{onClick:i}),n)}))})};function g(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function y(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?g(Object(r),!0).forEach((function(n){(0,d.Z)(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):g(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}var m=function(e){var n=e.name,r=e.value,o=e.selectedKeywords,i=e.onClick;return(0,t.jsxs)("li",{className:"flex p-1 border-b border-indigo-500 cursor-pointer hover:bg-indigo-500 hover:text-indigo-800",children:[(0,t.jsx)("span",{className:"flex-grow font-sans",children:n}),(0,t.jsx)("input",{type:"checkbox",onChange:function(){return i(r)},checked:o.includes(r),className:"form-tick appearance-none h-6 w-6 border border-gray-300 rounded-md checked:border-transparent focus:outline-none checked:bg-yellow-400 checked:border-transparent"})]})},b=function(e){var n=e.keywords,r=void 0===n?[{name:"PHP",value:"php"},{name:"C#",value:"c#"}]:n,o=e.selectedKeywords,i=e.onClick,c=void 0===i?function(){}:i;return(0,t.jsx)("ul",{className:"text-white overflow-scroll",style:{overflow:"scroll",height:"80vh"},children:r.map((function(e,n){return(0,t.jsx)(m,y(y({},e),{},{selectedKeywords:o,onClick:c}),n)}))})},x=function(e){var n=e.cities,r=e.filterType,o=e.keywords,i=e.selectedKeywords,c=e.onChangeFilterType,s=e.onClickCity,a=e.onClickKeyword;return(0,t.jsxs)("div",{className:"bg-indigo-600 h-screen",children:[(0,t.jsx)("div",{className:"px-12 pb-4 pt-2 border-b border-indigo-900",children:(0,t.jsx)("h2",{className:"text-white text-2xl italic font-sans",children:"Jobsmap"})}),(0,t.jsx)(u,{buttons:[{name:"Villes",id:"cities"},{name:"Technos",id:"technologies"}],selectedId:r,onChange:c}),(0,t.jsxs)("div",{className:"mt-2 flex flex-col items-center justify-center px-4 text-white",children:[i.length>0&&(0,t.jsxs)("p",{children:["Villes contenants des offres avec : ",i.join(", ")]}),(0,t.jsxs)("p",{children:["Total: ",n.length]})]}),(0,t.jsxs)("div",{className:"pt-4 flex flex-col space-x-px",children:[(0,t.jsxs)("div",{className:"flex-1",children:["cities"===r&&(0,t.jsx)(v,{cities:n,onClick:s}),"technologies"===r&&(0,t.jsx)(b,{keywords:o,selectedKeywords:i,onClick:a})]}),(0,t.jsx)(l.default,{href:"/about",children:(0,t.jsx)("a",{className:"border text-center border-indigo-100 rounded-md p-2 text-white hover:text-indigo-600 hover:bg-indigo-100",children:"A propos"})})]})]})};function w(e,n){var r;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,n){if(!e)return;if("string"===typeof e)return j(e,n);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return j(e,n)}(e))||n&&e&&"number"===typeof e.length){r&&(e=r);var t=0,o=function(){};return{s:o,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,c=!0,s=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return c=e.done,e},e:function(e){s=!0,i=e},f:function(){try{c||null==r.return||r.return()}finally{if(s)throw i}}}}function j(e,n){(null==n||n>e.length)&&(n=e.length);for(var r=0,t=new Array(n);r<n;r++)t[r]=e[r];return t}var k=!0,O=function(e){var n,l,a=(null===(n=e.places[0])||void 0===n?void 0:n.coords)||[45.78365,3.10013],u=(0,i.useState)(a),d=u[0],f=u[1],h=(0,i.useState)(e.places),p=h[0],v=h[1],g=(0,i.useState)([]),y=g[0],m=g[1],b=(0,i.useState)("technologies"),j=b[0],k=b[1],O=(0,i.useRef)();O.current;(0,i.useEffect)((function(){P()}),[]),(0,i.useEffect)((function(){O.current=d}),[d]);var C,N=(0,s.default)((function(){return Promise.all([r.e(269),r.e(677)]).then(r.bind(r,4677))}),{ssr:!1,loadableGenerated:{webpack:function(){return[4677]},modules:["index.js -> ../components/map"]}}),P=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=(0,o.Z)(y);if(null!==n){var t=y.indexOf(n);t>=0?r.splice(t,1):r.push(n)}var i=e.places;if(console.log("newKeywords",r),r.length>0){var c,s=w(r);try{var l=function(){var e=c.value;i=i.filter((function(n){return n.keywords.find((function(n){return n.keyword===e}))})),console.log("curKeyword",e),console.log("filteredPlaces",i.length)};for(s.s();!(c=s.n()).done;)l()}catch(a){s.e(a)}finally{s.f()}}console.log("filteredPlaces",i.length),v(i),m(r),k("cities"),f(i[0].coords)},S=[],_=[],E=[],T=w(p);try{for(T.s();!(C=T.n()).done;){var K=C.value,D=K.keywords.map((function(e){return"".concat(e.keyword," : ").concat(e.count)})),A={title:"".concat(K.name," <br/> ").concat(D.join("<br />")),coords:K.coords},I={name:K.name,value:K.total,coords:K.coords},F=K.keywords;S.push(A),_.push(I),E.push(F)}}catch(R){T.e(R)}finally{T.f()}for(var M=[],Z=[],G=0,V=E;G<V.length;G++){var X,H=w(V[G]);try{for(H.s();!(X=H.n()).done;){var J=X.value;M.includes(J.keyword)||(M.push(J.keyword),Z.push({name:J.keyword,value:J.keyword}))}}catch(R){H.e(R)}finally{H.f()}}return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(c.default,{children:[(0,t.jsx)("title",{children:"Cartographie des offres d'emplois tech en France"}),(0,t.jsx)("meta",{name:"viewport",content:"initial-scale=1.0, width=device-width"})]}),(0,t.jsxs)("div",{className:"flex",children:[(0,t.jsx)("div",{className:"flex-none",children:(0,t.jsx)(x,{filterType:j,onChangeFilterType:function(e){k(e)},cities:_,keywords:Z,selectedKeywords:y,onClickCity:function(e){console.log("mapComp.getCenter()",l.getCenter()),l.flyTo(e),setTimeout((function(){console.log("mapComp.getCenter()",l.getCenter())}),2e3)},onClickKeyword:function(e){console.log("pages/index #onClickkeyword keyword",e),P(e)}})}),(0,t.jsx)("div",{className:"flex flex-col flex-grow h-screen",children:(0,t.jsx)("div",{className:"flex-1",children:(0,t.jsx)(N,{defaultCenter:a,center:d,markers:S,getMap:function(e){var n=e.map;console.log("pages/index getMap",n),console.log("pages/index getMap map.getCenter",n.getCenter()),l=n}})})})]})]})}},8581:function(e,n,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(2656)}])}},function(e){e.O(0,[774,444,888,179],(function(){return n=8581,e(e.s=n);var n}));var n=e.O();_N_E=n}]);